<!DOCTYPE html>
<html dir="ltr" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords"
        content="wrappixel, admin dashboard, html css dashboard, web dashboard, bootstrap 5 admin, bootstrap 5, css3 dashboard, bootstrap 5 dashboard, Xtreme lite admin bootstrap 5 dashboard, frontend, responsive bootstrap 5 admin template, Xtreme admin lite design, Xtreme admin lite dashboard bootstrap 5 dashboard template">
    <meta name="description"
        content="Xtreme Admin Lite is powerful and clean admin dashboard template, inpired from Bootstrap Framework">
    <meta name="robots" content="noindex,nofollow">
    <title>Adan Perfumes- Sales Report</title>
    <link rel="canonical" href="https://www.wrappixel.com/templates/xtreme-admin-lite/" />
    <!-- Favicon icon -->
    <link rel="icon" type="image/png" sizes="16x16" href="../../assets/images/favicon.png">
    <!-- Custom CSS -->
    <link href="../../assets/libs/chartist/dist/chartist.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="../../dist/css/style.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.datatables.net/1.13.2/css/jquery.dataTables.min.css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
</head>

<body>
    <!-- ============================================================== -->
    <!-- Preloader - style you can find in spinners.css -->
    <!-- ============================================================== -->
    {{!-- <div class="preloader">
        <div class="lds-ripple">
            <div class="lds-pos"></div>
            <div class="lds-pos"></div>
        </div>
    </div> --}}
    <!-- ============================================================== -->
    <!-- Main wrapper - style you can find in pages.scss -->
    <!-- ============================================================== -->
    <div id="main-wrapper" data-layout="vertical" data-navbarbg="skin5" data-sidebartype="full"
        data-sidebar-position="absolute" data-header-position="absolute" data-boxed-layout="full">
        <!-- ============================================================== -->
        <!-- Topbar header - style you can find in pages.scss -->
        <!-- ============================================================== -->
        <header class="topbar" data-navbarbg="skin5">
            <nav class="navbar top-navbar navbar-expand-md navbar-dark">
                <div class="navbar-header" data-logobg="skin5">
                    <!-- ============================================================== -->
                    <!-- Logo -->
                    <!-- ============================================================== -->
                    <a class="navbar-brand" href="/admin">
                        <!-- Logo icon -->
                        <b class="logo-icon">
                            <!--You can put here icon as well // <i class="wi wi-sunset"></i> //-->
                            <!-- Dark Logo icon -->
                            {{!-- <img src="../../assets/images/logo-icon.png" alt="homepage" class="dark-logo" />
                            <!-- Light Logo icon -->
                            <img src="../../assets/images/logo-light-icon.png" alt="homepage" class="light-logo" /> --}}
                            <h3>Adan Perfumes</h3>
                        </b>
                        <!--End Logo icon -->
                        <!-- Logo text -->
                        {{!-- <span class="logo-text">
                            <!-- dark Logo text -->
                            <img src="../../assets/images/logo-text.png" alt="homepage" class="dark-logo" />
                            <!-- Light Logo text -->
                            <img src="../../assets/images/logo-light-text.png" class="light-logo" alt="homepage" />
                        </span> --}}
                    </a>
                    <!-- ============================================================== -->
                    <!-- End Logo -->
                    <!-- ============================================================== -->
                    <!-- This is for the sidebar toggle which is visible on mobile only -->
                    <a class="nav-toggler waves-effect waves-light d-block d-md-none" href="javascript:void(0)"><i
                            class="ti-menu ti-close"></i></a>
                </div>
                <!-- ============================================================== -->
                <!-- End Logo -->
                <!-- ============================================================== -->
                <div class="navbar-collapse collapse" id="navbarSupportedContent" data-navbarbg="skin5">
                    <!-- ============================================================== -->
                    <!-- toggle and nav items -->
                    <!-- ============================================================== -->
                    <ul class="navbar-nav float-start me-auto">
                        <!-- ============================================================== -->
                        <!-- Search -->
                        <!-- ============================================================== -->
                        {{!-- <li class="nav-item search-box"> <a class="nav-link waves-effect waves-dark"
                                href="javascript:void(0)"><i class="ti-search"></i></a>
                            <form class="app-search position-absolute">
                                <input type="text" class="form-control" placeholder="Search &amp; enter"> <a
                                    class="srh-btn"><i class="ti-close"></i></a>
                            </form>
                        </li> --}}
                    </ul>
                    <!-- ============================================================== -->
                    <!-- Right side toggle and nav items -->
                    <!-- ============================================================== -->
                    <ul class="navbar-nav float-end">
                       <button class="btn btn-secondary"> <a href="/admin/logout" style="color: aliceblue;">logout</a></button>
                    </ul>
                    <ul class="navbar-nav float-end">
                    
                    
                    </ul>
                </div>
            </nav>
        </header>
        <!-- ============================================================== -->
        <!-- End Topbar header -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- Left Sidebar - style you can find in sidebar.scss  -->
        <!-- ============================================================== -->
        <div class="container-fluid row">
        <div class="col-3">
        <aside class="left-sidebar" data-sidebarbg="skin6">
            <!-- Sidebar scroll-->
            <div class="scroll-sidebar">
                <!-- Sidebar navigation-->
                <nav class="sidebar-nav">
                    <ul id="sidebarnav">
                        <!-- User Profile-->
                        <li>
                            <!-- User Profile-->
                            <div class="user-profile d-flex no-block dropdown m-t-20">
                                <div class="user-pic"><img src="../../assets/images/users/1.jpg" alt="users"
                                        class="rounded-circle" width="40" /></div>
                                <div class="user-content hide-menu m-l-10">
                              
                                        <h5 class="m-b-0 user-name font-medium">Admin
                                         
                                                </h5>
                                        <span class="op-5 user-email">admin@gmail.com</span>
                                    </a>
                                 
                                </div>
                            </div>
                            <!-- End User Profile-->
                        </li>
                       
                        <!-- User Profile-->
                        <li class="sidebar-item"> <a class="sidebar-link waves-effect waves-dark sidebar-link"
                                href="/admin/index" aria-expanded="false"><i class="mdi mdi-view-dashboard"></i><span
                                    class="hide-menu">Dashboard</span></a></li>
                       
                        <li class="sidebar-item"> <a class="sidebar-link waves-effect waves-dark sidebar-link"
                                href="/admin/productManage" aria-expanded="false"><i class="mdi mdi-border-all"></i><span
                                    class="hide-menu">Products</span></a></li>
                        <li class="sidebar-item"> <a class="sidebar-link waves-effect waves-dark sidebar-link"
                                href="/admin/userManage" aria-expanded="false"><i class="mdi mdi-face"></i><span
                                    class="hide-menu">Users</span></a></li>
                        <li class="sidebar-item"> <a class="sidebar-link waves-effect waves-dark sidebar-link"
                                href="/admin/orderManage" aria-expanded="false"><i class="mdi mdi-file"></i><span
                                    class="hide-menu">Orders</span></a></li>
                        <li class="sidebar-item"> <a class="sidebar-link waves-effect waves-dark sidebar-link"
                                href="/admin/categoryManage" aria-expanded="false"><i class="mdi mdi-folder"></i><span
                                    class="hide-menu">Category</span></a></li>
                        <li class="sidebar-item"> <a class="sidebar-link waves-effect waves-dark sidebar-link"
                                href="/admin/couponManage" aria-expanded="false"><i
                                    class="mdi mdi-ticket-percent"></i><span class="hide-menu">Coupons</span></a></li>
                         <li class="sidebar-item"> <a class="sidebar-link waves-effect waves-dark sidebar-link"
                                href="/admin/salesReport" aria-expanded="false"><i
                                    class="mdi mdi-file-chart"></i><span class="hide-menu">Sales report</span></a></li>

                    </ul>

                </nav>
                <!-- End Sidebar navigation -->
            </div>
            <!-- End Sidebar scroll-->
        </aside>
        </div>
        <!-- ============================================================== -->
        <!-- End Left Sidebar - style you can find in sidebar.scss  -->
        <!-- ============================================================== -->
    {{!--  main--}}
 <div class="col-9">
    <div class="orders-main">
  <div class="order-container">
    <h3>Filter</h3>
    <div class="container-fluid d-flex align-items-end tablesHeader">
      <h6 >Filter by : </h6>
      <a href="/admin/salesReport?filter=lastWeek" class="btn btn-dark ms-2">Last week</a>
      <a href="/admin/salesReport?filter=thisMonth" class="btn btn-dark ms-2">This Month</a>
      <a href="/admin/salesReport?filter=thisYear" class="btn btn-dark ms-2">This year</a>
    </div>
    <div class="container-fluid filter-head pt-4 tablesHeader">
       <h6>Filter by date : </h6>
      <form action="/admin/salesReport" class="d-flex" method="get">
        <input type="date" class="form-control" name="startDate" value="{{startDate}}" onchange="this.form.submit()">
        to
        <input type="date" class="form-control" name="endDate" value="{{endDate}}" onchange="this.form.submit()">
      </form>
    </div>
    <div class="report-btns container-fluid tablesHeader">
      <h3 >Sales Report</h3>
      <div>
        <button onclick="downloadPdf()" class="btn btn-dark ">Download in PDF</button>
        <button onclick="downloadExcel2()" class="btn btn-dark ">Download in Excel</button>
      </div>
    </div>
    <div class="row mt-2 p-3">
        <div class="orders-table">
            <table class="table table-striped">
                <thead>
                    <tr>
                      <th colspan="3" class="thead">Sales report {{startDate}} to {{endDate}}</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                        <th scope="col">Total Revenue</th>
                        <td scope="col">₹{{totalRevenue}} </td>
                      </tr>
                    <tr>
                        <th scope="col">Total Orders</th>
                        <td scope="col">{{totalOrders}} </td>
                      </tr>
                    <tr>
                        <th scope="col">Total Pending</th>
                        <td scope="col">{{totalPending}}
                    <tr>
                        <th scope="col">Total Dispatch</th>
                        <td scope="col">{{totalDispatch}}</td>
                      </tr>
                </tbody>
              </table>
        </div>
    </div>
   
   
    <h3 class="mt-3 head3">Orders</h3>
    <div class="row mt-2 p-3">
        <div class="orders-table" id="content">
          <div class="table-responsive">
            <table class="table table-hover" id="orderTable">
                <thead>
                    <tr>
                      <th scope="col">No</th>
                      <th scope="col">Name</th>
                      <th scope="col">date</th>
                      <th scope="col">Payment Status</th>
                      <th scope="col">Status</th>
                      <th scope="col">Quantity</th>
                      <th scope="col">Total</th>
                    </tr>
                  </thead>
                  <tbody>
                    
                    {{#each orders}}
                    <tr>
                      <td scope="row">
                        {{this.orderId}}
                       </td>
                      <td scope="row">
                        <a href="/admin/orderDetails/{{this._id}}">
                         {{this.product.[0].title}}
                        </a>
                       </td>
                      <td>{{this.createdAt  }}</td>
                      <td>
                        {{#if this.paid}} Paid
                        {{else}} Not Paid 
                        {{/if}}
                        </td>
                      <td>
                           {{this.orderStatus }} 
                    </td>
                      
                    <td>{{this.totalQuantity }} </td>
                      <td>₹{{this.total }} </td>
                    </tr>
                    {{/each}}

                    
                  </tbody>
              </table>
              </div>
        </div>
    </div>
    
  </div>
</div>
</div>
</div>



<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.1/xlsx.full.min.js"></script>
   <script
      src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
      crossorigin="anonymous"
    ></script>

<script>
    let orders=[]
    {{#each orders}}
    orders.push(['{{this.orderId}}','{{this.address}}','{{this.product.[0].title}}','{{this.product.[0].price}}','{{this.totalQuantity}}','{{this.total}}'])
    {{/each}}
    let totalRevenue= '{{totalRevenue}}'
    let totalOrders= '{{totalOrders}}'
    let totalDispatch= '{{totalDispatch}}'
    let totalPending= '{{totalPending}}'
    let startDate= '{{startDate}}'
    let endDate= '{{endDate}}'
 
 const { jsPDF } = window.jspdf;
function downloadPdf() {
      const doc= new jsPDF();
      doc.setFont("helvetica", "bold");
      doc.text(15, 20, "Adan Perfumes Sales Report ");
      doc.setFont("helvetica", "italic");
      doc.text(15, 30, `From ${startDate} to ${endDate}`);
      doc.autoTable({
        head: [['Type', 'Details']],
        body: [
              
              ['Total Orders', totalOrders],
              ['Total Revenue', totalRevenue],
              ['Total Pending', totalPending],
              ['Total Dispatch', totalDispatch],
              
              ],
        startY: 40
      })
      doc.text(15, doc.lastAutoTable.finalY+20, "order info");
      doc.autoTable({
        head: [['Order ID','Name', 'Product Name','Price','Quantity','Sub Total']],
        body: orders,
        startY: doc.lastAutoTable.finalY + 30
      })
      doc.save('sales-report.pdf');
    }
   
function downloadExcel2() {

  const orders = [
    {{#each orders}}
    ['{{this.orderId}}', '{{this.address}}', '{{this.product.[0].title}}', '{{this.product.[0].price}}', '{{this.totalQuantity}}', '{{this.total}}'],
    {{/each}}
  ];
  const totalRevenue = '{{totalRevenue}}';
  const totalOrders = '{{totalOrders}}';
  const totalDispatch = '{{totalDispatch}}';
  const totalPending = '{{totalPending}}';
  const startDate = '{{startDate}}';
  const endDate = '{{endDate}}';
 var wb = XLSX.utils.book_new();
  var ws = XLSX.utils.aoa_to_sheet([
    ['Adan Perfumes'],
    ['Sales Report'],
    [''],
    [`From:${startDate} to ${endDate}` ],
    [''],
    [`Total Orders  : ${totalOrders}`],
    [`Total Revenue : ${totalRevenue}`],
    [`Total Dispatch: ${totalDispatch}`],
    [`Total Pending : ${totalPending}`],
    [''],
    ['Order ID', 'Customer', 'Product Name', 'Price', 'Quantity', 'Sub Total'],
    ...orders
  ]);

  var wscols = [
    { wch: 8 },
    { wch: 15 },
    { wch: 13 },
    { wch: 8 },
    { wch: 8 },
    { wch: 8 }
  ];
  ws['!cols'] = wscols;

  XLSX.utils.book_append_sheet(wb, ws, 'Sales Report');
  XLSX.writeFile(wb, 'sales-report.xlsx');





}

</script>
   <script src="//cdn.datatables.net/1.13.2/js/jquery.dataTables.min.js"></script>
   <script>$(document).ready( function () {
    $('#orderTable').DataTable();
} );

     </script>
{{!-- main --}}
</body>

</html>
